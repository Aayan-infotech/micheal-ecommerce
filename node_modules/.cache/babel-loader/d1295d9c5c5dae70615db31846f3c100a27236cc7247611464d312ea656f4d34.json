{"ast":null,"code":"import { createSlice, createAsyncThunk } from '@reduxjs/toolkit';\nimport axios from 'axios';\nimport { toast } from 'react-toastify';\n\n// Create an async thunk for login\nexport const loginUser = createAsyncThunk('auth/loginUser', async (formData, {\n  rejectWithValue\n}) => {\n  try {\n    const response = await axios.post('http://44.196.192.232:3129/api/auth/login', formData);\n    if (response.data.success) {\n      // Store token and userId in sessionStorage\n      const {\n        token,\n        data: {\n          id\n        }\n      } = response.data;\n      sessionStorage.setItem('token', token);\n      sessionStorage.setItem('userId', id);\n      return response.data;\n    } else {\n      return rejectWithValue(response.data.message);\n    }\n  } catch (error) {\n    var _error$response, _error$response$data;\n    return rejectWithValue(((_error$response = error.response) === null || _error$response === void 0 ? void 0 : (_error$response$data = _error$response.data) === null || _error$response$data === void 0 ? void 0 : _error$response$data.message) || 'Something went wrong. Please try again.');\n  }\n});\nconst loginSlice = createSlice({\n  name: 'auth',\n  initialState: {\n    user: null,\n    token: null,\n    isLoading: false,\n    error: null\n  },\n  reducers: {\n    // logout: (state) => {\n    //   sessionStorage.removeItem('token');\n    //   sessionStorage.removeItem('userId');\n    //   state.user = null;\n    //   state.token = null;\n    // }\n  },\n  extraReducers: builder => {\n    builder.addCase(loginUser.pending, state => {\n      state.isLoading = true;\n      state.error = null;\n    }).addCase(loginUser.fulfilled, (state, action) => {\n      state.isLoading = false;\n      state.token = action.payload.token;\n      state.user = action.payload.data;\n      toast.success(\"Login Successful!\");\n    }).addCase(loginUser.rejected, (state, action) => {\n      state.isLoading = false;\n      state.error = action.payload;\n      toast.error(action.payload || 'Login failed');\n    });\n  }\n});\nexport default loginSlice.reducer;","map":{"version":3,"names":["createSlice","createAsyncThunk","axios","toast","loginUser","formData","rejectWithValue","response","post","data","success","token","id","sessionStorage","setItem","message","error","_error$response","_error$response$data","loginSlice","name","initialState","user","isLoading","reducers","extraReducers","builder","addCase","pending","state","fulfilled","action","payload","rejected","reducer"],"sources":["D:/aayan-project/micheal-ecommerce/src/components/redux/liginSlice.js"],"sourcesContent":["import { createSlice, createAsyncThunk } from '@reduxjs/toolkit';\r\nimport axios from 'axios';\r\nimport { toast } from 'react-toastify';\r\n\r\n// Create an async thunk for login\r\nexport const loginUser = createAsyncThunk(\r\n  'auth/loginUser',\r\n  async (formData, { rejectWithValue }) => {\r\n    try {\r\n      const response = await axios.post('http://44.196.192.232:3129/api/auth/login', formData);\r\n      if (response.data.success) {\r\n        // Store token and userId in sessionStorage\r\n        const { token, data: { id } } = response.data;\r\n        sessionStorage.setItem('token', token);\r\n        sessionStorage.setItem('userId', id);\r\n        return response.data;\r\n      } else {\r\n        return rejectWithValue(response.data.message);\r\n      }\r\n    } catch (error) {\r\n      return rejectWithValue(error.response?.data?.message || 'Something went wrong. Please try again.');\r\n    }\r\n  }\r\n);\r\n\r\nconst loginSlice = createSlice({\r\n  name: 'auth',\r\n  initialState: {\r\n    user: null,\r\n    token: null,\r\n    isLoading: false,\r\n    error: null,\r\n  },\r\n  reducers: {\r\n    // logout: (state) => {\r\n    //   sessionStorage.removeItem('token');\r\n    //   sessionStorage.removeItem('userId');\r\n    //   state.user = null;\r\n    //   state.token = null;\r\n    // }\r\n  },\r\n  extraReducers: (builder) => {\r\n    builder\r\n      .addCase(loginUser.pending, (state) => {\r\n        state.isLoading = true;\r\n        state.error = null;\r\n      })\r\n      .addCase(loginUser.fulfilled, (state, action) => {\r\n        state.isLoading = false;\r\n        state.token = action.payload.token;\r\n        state.user = action.payload.data;\r\n        toast.success(\"Login Successful!\");\r\n      })\r\n      .addCase(loginUser.rejected, (state, action) => {\r\n        state.isLoading = false;\r\n        state.error = action.payload;\r\n        toast.error(action.payload || 'Login failed');\r\n      });\r\n  }\r\n});\r\n\r\nexport default loginSlice.reducer;\r\n"],"mappings":"AAAA,SAASA,WAAW,EAAEC,gBAAgB,QAAQ,kBAAkB;AAChE,OAAOC,KAAK,MAAM,OAAO;AACzB,SAASC,KAAK,QAAQ,gBAAgB;;AAEtC;AACA,OAAO,MAAMC,SAAS,GAAGH,gBAAgB,CACvC,gBAAgB,EAChB,OAAOI,QAAQ,EAAE;EAAEC;AAAgB,CAAC,KAAK;EACvC,IAAI;IACF,MAAMC,QAAQ,GAAG,MAAML,KAAK,CAACM,IAAI,CAAC,2CAA2C,EAAEH,QAAQ,CAAC;IACxF,IAAIE,QAAQ,CAACE,IAAI,CAACC,OAAO,EAAE;MACzB;MACA,MAAM;QAAEC,KAAK;QAAEF,IAAI,EAAE;UAAEG;QAAG;MAAE,CAAC,GAAGL,QAAQ,CAACE,IAAI;MAC7CI,cAAc,CAACC,OAAO,CAAC,OAAO,EAAEH,KAAK,CAAC;MACtCE,cAAc,CAACC,OAAO,CAAC,QAAQ,EAAEF,EAAE,CAAC;MACpC,OAAOL,QAAQ,CAACE,IAAI;IACtB,CAAC,MAAM;MACL,OAAOH,eAAe,CAACC,QAAQ,CAACE,IAAI,CAACM,OAAO,CAAC;IAC/C;EACF,CAAC,CAAC,OAAOC,KAAK,EAAE;IAAA,IAAAC,eAAA,EAAAC,oBAAA;IACd,OAAOZ,eAAe,CAAC,EAAAW,eAAA,GAAAD,KAAK,CAACT,QAAQ,cAAAU,eAAA,wBAAAC,oBAAA,GAAdD,eAAA,CAAgBR,IAAI,cAAAS,oBAAA,uBAApBA,oBAAA,CAAsBH,OAAO,KAAI,yCAAyC,CAAC;EACpG;AACF,CACF,CAAC;AAED,MAAMI,UAAU,GAAGnB,WAAW,CAAC;EAC7BoB,IAAI,EAAE,MAAM;EACZC,YAAY,EAAE;IACZC,IAAI,EAAE,IAAI;IACVX,KAAK,EAAE,IAAI;IACXY,SAAS,EAAE,KAAK;IAChBP,KAAK,EAAE;EACT,CAAC;EACDQ,QAAQ,EAAE;IACR;IACA;IACA;IACA;IACA;IACA;EAAA,CACD;EACDC,aAAa,EAAGC,OAAO,IAAK;IAC1BA,OAAO,CACJC,OAAO,CAACvB,SAAS,CAACwB,OAAO,EAAGC,KAAK,IAAK;MACrCA,KAAK,CAACN,SAAS,GAAG,IAAI;MACtBM,KAAK,CAACb,KAAK,GAAG,IAAI;IACpB,CAAC,CAAC,CACDW,OAAO,CAACvB,SAAS,CAAC0B,SAAS,EAAE,CAACD,KAAK,EAAEE,MAAM,KAAK;MAC/CF,KAAK,CAACN,SAAS,GAAG,KAAK;MACvBM,KAAK,CAAClB,KAAK,GAAGoB,MAAM,CAACC,OAAO,CAACrB,KAAK;MAClCkB,KAAK,CAACP,IAAI,GAAGS,MAAM,CAACC,OAAO,CAACvB,IAAI;MAChCN,KAAK,CAACO,OAAO,CAAC,mBAAmB,CAAC;IACpC,CAAC,CAAC,CACDiB,OAAO,CAACvB,SAAS,CAAC6B,QAAQ,EAAE,CAACJ,KAAK,EAAEE,MAAM,KAAK;MAC9CF,KAAK,CAACN,SAAS,GAAG,KAAK;MACvBM,KAAK,CAACb,KAAK,GAAGe,MAAM,CAACC,OAAO;MAC5B7B,KAAK,CAACa,KAAK,CAACe,MAAM,CAACC,OAAO,IAAI,cAAc,CAAC;IAC/C,CAAC,CAAC;EACN;AACF,CAAC,CAAC;AAEF,eAAeb,UAAU,CAACe,OAAO","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}